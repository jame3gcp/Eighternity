# 전체 기능 테스트 가이드

## ✅ 완료된 단계
- [x] Supabase 연결 설정
- [x] RLS 정책 설정
- [x] 사용자 정보 저장 확인

## 📋 테스트 체크리스트

### 1단계: 라이프 로그 저장/조회 테스트

#### 테스트 방법:
1. 브라우저에서 `http://localhost:3000` 접속
2. 홈 페이지에서 **"입력"** 버튼 클릭
3. 라이프 로그 폼에서 다음 입력:
   - 기분: 좋음
   - 컨디션: 보통
   - 수면: 좋음
   - 일정: 보통
   - 메모: "테스트 입력"
4. **"저장하기"** 버튼 클릭

#### 확인 사항:
- ✅ 저장 성공 메시지 표시
- ✅ Supabase 대시보드 > `life_logs` 테이블에 데이터 확인
- ✅ 폼이 닫히고 하이브리드 추천 배지 표시

#### Supabase 확인:
```sql
-- Supabase SQL Editor에서 실행
SELECT * FROM life_logs ORDER BY created_at DESC LIMIT 1;
```

---

### 2단계: 하이브리드 추천 시스템 테스트

#### 테스트 방법:
1. 라이프 로그 저장 후 홈 페이지 새로고침
2. **"하이브리드 추천 활성화"** 배지 확인
3. 추천 메시지와 점수 확인

#### 확인 사항:
- ✅ "하이브리드 추천 활성화" 배지 표시
- ✅ 추천 메시지에 라이프 로그 반영 여부 확인
- ✅ 도메인 점수(직업운, 애정운, 재물운, 건강운) 조정 확인
- ✅ "추천 이유" 섹션에 라이프 로그 분석 표시

#### API 직접 테스트:
```bash
# 터미널에서 실행
curl -X GET "http://localhost:3000/api/fortune/hybrid?includeLifeLog=true" \
  -H "Cookie: user_saju=..."
```

---

### 3단계: 모든 API 엔드포인트 테스트

#### 3-1. 프로필 API
```bash
curl http://localhost:3000/api/profile
```
**확인:** 오행 정보와 강점/주의사항 반환

#### 3-2. 오늘의 운세 API
```bash
curl http://localhost:3000/api/fortune/today
```
**확인:** 오늘 날짜의 사주 기반 운세 반환

#### 3-3. 캘린더 운세 API
```bash
curl http://localhost:3000/api/fortune/calendar
```
**확인:** 다음 7일간의 운세 배열 반환

#### 3-4. 질문 답변 API
```bash
curl -X POST http://localhost:3000/api/fortune/question \
  -H "Content-Type: application/json" \
  -d '{"category": "work"}'
```
**확인:** 카테고리별 맞춤 답변 반환

---

### 4단계: UI 통합 테스트

#### 테스트 시나리오:

**시나리오 1: 신규 사용자 플로우**
1. `/onboarding` 접속
2. 생년월일 입력 (예: 1990-01-01)
3. 홈 페이지로 리다이렉트
4. 사주 기반 운세 확인
5. 라이프 로그 입력
6. 하이브리드 추천 확인

**시나리오 2: 기존 사용자 플로우**
1. 쿠키가 있는 상태에서 홈 페이지 접속
2. 저장된 라이프 로그 자동 로드
3. 하이브리드 추천 표시
4. 라이프 로그 수정 가능

**시나리오 3: 라이프 로그 수정**
1. 홈 페이지에서 "수정" 버튼 클릭
2. 기존 값이 폼에 로드되는지 확인
3. 값 수정 후 저장
4. 추천이 업데이트되는지 확인

---

## 🐛 문제 해결

### 문제 1: 라이프 로그 저장 실패
**증상:** "저장에 실패했습니다" 오류

**확인 사항:**
1. Supabase 연결 상태 확인
2. RLS 정책 확인 (Service Role Key 설정 여부)
3. 브라우저 콘솔 오류 확인

**해결:**
```bash
# .env.local 확인
SUPABASE_SERVICE_ROLE_KEY=설정되어있는지확인
```

### 문제 2: 하이브리드 추천이 표시되지 않음
**증상:** 라이프 로그를 입력했지만 배지가 나타나지 않음

**확인 사항:**
1. `/api/fortune/hybrid` 응답 확인
2. `lifeLogAnalysis.hasData` 값 확인
3. 브라우저 네트워크 탭에서 API 응답 확인

### 문제 3: Supabase에 데이터가 저장되지 않음
**증상:** UI에서는 성공했지만 DB에 데이터 없음

**확인 사항:**
1. Supabase 대시보드 > Table Editor 확인
2. RLS 정책이 올바르게 설정되었는지 확인
3. Service Role Key 사용 여부 확인

---

## 📊 테스트 결과 기록

### 테스트 일자: ___________

| 테스트 항목 | 상태 | 비고 |
|------------|------|------|
| 온보딩 | ⬜ | |
| 라이프 로그 저장 | ⬜ | |
| 라이프 로그 조회 | ⬜ | |
| 하이브리드 추천 | ⬜ | |
| 프로필 API | ⬜ | |
| 운세 API | ⬜ | |
| 캘린더 API | ⬜ | |
| 질문 API | ⬜ | |
| UI 통합 | ⬜ | |

---

## 🎯 다음 단계

테스트 완료 후:
1. 발견된 버그 수정
2. 성능 최적화
3. 사용자 경험 개선
4. 프로덕션 배포 준비
